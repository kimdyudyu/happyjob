<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.happy.jobkorea.hla.dao.UserInfoDao">

	<select id="SelectUserInfo" resultType="kr.happy.jobkorea.hla.model.UserInfoModel">
	/*kr.happy.jobkorea.hla.dao.UserInfoDao.SelectUserInfo*/
	SELECT
		name,
		loginID,
		password,
		email,
		tel1,
		tel2,
		tel3,
		joinDate,
		area,
		birthday,
		user_type,
		sex
	FROM tb_userinfo
		<where>
			<if test="(UserName != null) and (!UserName.equals(''))">			
				AND name like concat('%',#{UserName},'%')
			</if>
			<if test="(fromDt != null) and (!fromDt.equals(''))">
				AND DATE_FORMAT(joinDate,'%Y%m%d')  <![CDATA[ >= ]]>  REPLACE( #{fromDt} , '-', '')
			</if>    
			<if test="(toDt != null) and (!toDt.equals(''))">
				AND DATE_FORMAT(joinDate,'%Y%m%d') <![CDATA[ <= ]]>  REPLACE( #{toDt}, '-', '')
			</if>
		</where>
			ORDER BY joinDate DESC
	      	LIMIT #{pageIndex}, #{pageSize}
	</select>
	
	<select id="getSelectedCnt" resultType="int">
	/*kr.happy.jobkorea.hla.dao.UserInfoDao.getSelectedCnt*/
	SELECT
		COUNT(*) AS SelectedCnt
	FROM tb_userinfo
		<where>
			<if test="(UserName != null) and (!UserName.equals(''))">			
				AND name like concat('%',#{UserName},'%')
			</if>
			<if test="(fromDt != null) and (!fromDt.equals(''))">
				AND DATE_FORMAT(joinDate,'%Y%m%d')  <![CDATA[ >= ]]>  REPLACE( #{fromDt} , '-', '')
			</if>    
			<if test="(toDt != null) and (!toDt.equals(''))">
				AND DATE_FORMAT(joinDate,'%Y%m%d') <![CDATA[ <= ]]>  REPLACE( #{toDt}, '-', '')
			</if>
		</where>
	</select>
	
	<insert id="RegistUser">
		/*kr.happy.jobkorea.hla.dao.UserInfoDao.RegistUser*/		 
		INSERT INTO tb_userinfo
		(
			loginID,
			user_type,
			name,
			password,
			email,
			sex,
			tel1,
			tel2,
			tel3,
			joinDate,
			area,
			birthday
		)
		VALUES
		(
				#{loginID}
			,	#{user_type}			
			,	#{name}
			,	#{password}
			,	#{email}
			,	#{sex}
			,	#{tel1}
			,	#{tel2}
			,	#{tel3}
			,	NOW()
			,	#{area}
			,	REPLACE( #{birthday} , '-', '')	
		)		
	</insert>
	
	<update id="UpdateUser">
	/*kr.happy.jobkorea.hla.dao.UserInfoDao.UpdateUser*/
	UPDATE tb_userinfo
	SET
		name = #{name},
		password = #{password},
		email = #{email},
		sex = #{sex},
		tel1 = #{tel1},
		tel2 = #{tel2},
		tel3 = #{tel3},
		area = #{area},
		birthday = #{birthday}	
	WHERE
		loginID = #{loginID}
	</update>
	
	



</mapper>